# Services Page Architecture Integration Guide

> **Generated by**: Internal Architecture Mapper Agent
> **Date**: 2025-10-15
> **Purpose**: Map monorepo structure and provide integration guidance for Services page implementation
> **Status**: Complete Analysis

## Table of Contents

1. [Executive Summary](#executive-summary)
2. [Monorepo Architecture Overview](#monorepo-architecture-overview)
3. [Package Dependencies](#package-dependencies)
4. [Component Placement Guidelines](#component-placement-guidelines)
5. [Import Patterns](#import-patterns)
6. [Routing Integration](#routing-integration)
7. [Build Configuration](#build-configuration)
8. [Testing Architecture](#testing-architecture)
9. [Services Page Integration Points](#services-page-integration-points)
10. [Implementation Checklist](#implementation-checklist)
11. [Architectural Patterns to Follow](#architectural-patterns-to-follow)

---

## Executive Summary

The Reiki Goddess Healing project is a **TypeScript monorepo** using **npm workspaces** with 4 packages and 1 main application. The architecture follows a **shared component library pattern** where reusable components live in packages and are composed into pages in the main app.

**Key Architecture Characteristics**:

- **Build System**: Vite 6 + TypeScript 5.3 with composite projects
- **Component Strategy**: Two-tier (Shared Components + Page Compositions)
- **Routing**: React Router v6 with AppLayout wrapper
- **Testing**: Vitest + React Testing Library (17 existing tests)
- **Package Manager**: npm workspaces with TypeScript project references
- **Animation**: Framer Motion for transitions
- **Current Status**: 5 pages implemented (Home, About, Contact, Blog, Events)

**Services Page Current State**:

- Basic placeholder exists at `/apps/main/src/pages/Services.tsx`
- Enhanced ServicesPage component exists in shared-components
- ServicesSection component available (used on homepage)
- Ready for full implementation with design tokens

---

## Monorepo Architecture Overview

### Directory Structure

```
reiki-goddess-healing/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ main/                          # Main web application
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ pages/                 # Route-level page components
â”‚       â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ About.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ Services.tsx       â† TARGET: Update this file
â”‚       â”‚   â”‚   â”œâ”€â”€ Events.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ Contact.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ Blog.tsx
â”‚       â”‚   â”‚   â””â”€â”€ NotFound.tsx
â”‚       â”‚   â”œâ”€â”€ components/            # App-specific components
â”‚       â”‚   â”‚   â””â”€â”€ PageTransition.tsx
â”‚       â”‚   â”œâ”€â”€ config/                # Configuration files
â”‚       â”‚   â”œâ”€â”€ __tests__/             # Integration tests
â”‚       â”‚   â”œâ”€â”€ App.tsx                # Root app with routing
â”‚       â”‚   â”œâ”€â”€ main.tsx               # Entry point
â”‚       â”‚   â””â”€â”€ index.css              # Global styles
â”‚       â”œâ”€â”€ public/                    # Static assets
â”‚       â”‚   â”œâ”€â”€ img/                   # Images served from /img/
â”‚       â”‚   â””â”€â”€ figma-screenshots/     # Design references
â”‚       â”œâ”€â”€ api/                       # Serverless functions (Vercel)
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ vite.config.ts
â”‚       â”œâ”€â”€ vitest.config.ts
â”‚       â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared-components/             # Reusable React components
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/                 # Complete page compositions
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HomePage.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AboutPage.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ServicesPage.tsx  â† AVAILABLE: Can use or extend
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ContactPage.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EventsPage.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BlogPage.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ Header/               # Navigation header
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer/               # Site footer
â”‚   â”‚   â”‚   â”œâ”€â”€ AppLayout/            # Page layout wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ Services/             # Services section component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ServicesSection.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ServicesSection.test.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ Hero/                 # Hero section variants
â”‚   â”‚   â”‚   â”œâ”€â”€ AnimatedSection/      # Animation wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ BookSessionCTA/       # Call-to-action component
â”‚   â”‚   â”‚   â”œâ”€â”€ [35+ other components]/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts              # Central export hub
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ [62 .tsx files, 17 tests]
â”‚   â”‚
â”‚   â”œâ”€â”€ design-system/                 # Design tokens and theme
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ colors.ts             # Color palette
â”‚   â”‚   â”‚   â”œâ”€â”€ typography.ts         # Font definitions
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.ts             # Spacing and sizing
â”‚   â”‚   â”‚   â”œâ”€â”€ breakpoints.ts        # Responsive breakpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ tailwind.config.ts    # Tailwind configuration
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â”œâ”€â”€ shared-utils/                  # Utility functions
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ [utility functions]
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ shared-assets/                 # Images and static assets
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ images.ts             # Image exports
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â”œâ”€â”€ images/                   # Image files
â”‚       â”‚   â”œâ”€â”€ icons/
â”‚       â”‚   â”œâ”€â”€ photos/
â”‚       â”‚   â””â”€â”€ logos/
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docs/                              # Documentation
â”‚   â”œâ”€â”€ project/
â”‚   â”‚   â”œâ”€â”€ ARCHITECTURE.md           # Architecture patterns
â”‚   â”‚   â”œâ”€â”€ PROJECT_SETUP.md
â”‚   â”‚   â””â”€â”€ [other docs]
â”‚   â”œâ”€â”€ design/
â”‚   â”‚   â”œâ”€â”€ services-page/            â† TARGET: Implementation docs here
â”‚   â”‚   â”œâ”€â”€ style-guide.md
â”‚   â”‚   â””â”€â”€ BRANDING-GUIDE.md
â”‚   â””â”€â”€ testing/
â”‚
â”œâ”€â”€ e2e/                              # End-to-end tests (Playwright)
â”œâ”€â”€ scripts/                          # Build and automation scripts
â”œâ”€â”€ package.json                      # Root workspace configuration
â”œâ”€â”€ tsconfig.json                     # Root TypeScript config
â”œâ”€â”€ vite.config.shared.ts            # Shared Vite config
â””â”€â”€ vitest.config.shared.ts          # Shared test config
```

### Workspace Configuration

**Root package.json**:

```json
{
  "name": "reiki-goddess-healing-monorepo",
  "workspaces": ["apps/*", "packages/*"],
  "scripts": {
    "dev": "npm run dev --workspaces --if-present",
    "build": "npm run build --workspaces --if-present",
    "test": "npm run test --workspaces --if-present"
  }
}
```

**Package Naming Convention**:

- All packages use `@reiki-goddess/` scope
- Main app: `@reiki-goddess/main`
- Packages: `@reiki-goddess/shared-components`, `@reiki-goddess/design-system`, etc.

---

## Package Dependencies

### Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      @reiki-goddess/main                     â”‚
â”‚                    (Main Application)                        â”‚
â”‚  â€¢ React Router v6 routing                                   â”‚
â”‚  â€¢ Framer Motion animations                                  â”‚
â”‚  â€¢ Resend email integration                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                  â”‚              â”‚
                   â–¼                  â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ shared-components  â”‚  â”‚ design-systemâ”‚  â”‚ shared-utilsâ”‚
      â”‚   (62 components)  â”‚  â”‚ (theme/tokens)â”‚  â”‚(utilities) â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ shared-assets   â”‚
      â”‚  (images/icons) â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Package Dependencies Detail

**@reiki-goddess/main** (apps/main/package.json):

```json
{
  "dependencies": {
    "@reiki-goddess/design-system": "*",
    "@reiki-goddess/shared-assets": "*",
    "@reiki-goddess/shared-components": "*",
    "@reiki-goddess/shared-utils": "*",
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.28.0",
    "framer-motion": "^12.23.12",
    "resend": "^6.1.2"
  }
}
```

**@reiki-goddess/shared-components**:

```json
{
  "peerDependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.0.0"
  }
}
```

**@reiki-goddess/design-system**:

```json
{
  "dependencies": {
    "tailwindcss": "^3.4.16",
    "tailwindcss-animate": "^1.0.7"
  }
}
```

### Internal Imports Pattern

All packages use **workspace asterisk references** (`"*"`) which resolve to local source during development:

```typescript
// In any package or app:
import { ServicesSection } from "@reiki-goddess/shared-components";
import { colors, typography } from "@reiki-goddess/design-system";
import { formatDate } from "@reiki-goddess/shared-utils";
```

**TypeScript Resolution**:

- Development: Resolves to `packages/*/src/` via path aliases
- Build: Resolves to `packages/*/dist/` via compiled declarations

---

## Component Placement Guidelines

### When to Create Components in Shared-Components vs Main App

#### Create in `packages/shared-components/src/` when:

âœ… **Reusable across multiple pages**

- Navigation, headers, footers
- Form components (SecureContactForm, FigmaContactForm)
- Section components (ServicesSection, MeetTheGoddess, Testimonials)
- Animation wrappers (AnimatedSection)
- Layout components (AppLayout, ResponsiveContainer)

âœ… **Design system components**

- Buttons, cards, modals
- Typography components
- Icon components

âœ… **Complete page compositions**

- Full page layouts that can be imported whole
- Example: `HomePage`, `AboutPage`, `ServicesPage`

#### Create in `apps/main/src/` when:

âœ… **Route-specific logic**

- Data fetching specific to that route
- Route parameters and query string handling
- App-specific state management

âœ… **Page wrappers**

- Thin wrappers that import from shared-components
- Route-level error boundaries
- Page-specific transitions

âœ… **Configuration**

- API endpoints
- Environment-specific settings

### Services Page Placement Strategy

**Recommended Approach** (Two-Tier Pattern):

1. **Enhanced Components** in `packages/shared-components/src/`:
   - `Services/ServiceDetail/` - Individual service detail cards
   - `Services/ServiceGrid/` - Grid layout for services
   - `Services/ServiceHero/` - Services page hero section
   - `pages/ServicesPage.tsx` - Complete page composition

2. **Route Wrapper** in `apps/main/src/pages/Services.tsx`:

   ```typescript
   import PageTransition from "../components/PageTransition";
   import { ServicesPage } from "@reiki-goddess/shared-components";

   function Services() {
     return (
       <PageTransition>
         <ServicesPage />
       </PageTransition>
     );
   }
   ```

**Benefits**:

- Reusable page composition in shared-components
- Route-specific animations in main app
- Easy to test components in isolation
- Can reuse ServicesPage in other apps/contexts

---

## Import Patterns

### Standard Import Patterns

#### 1. Importing Shared Components

```typescript
// âœ… Recommended: Named imports from package
import {
  ServicesSection,
  BookSessionCTA,
  AnimatedSection,
  ResponsiveContainer,
} from "@reiki-goddess/shared-components";

// âœ… Also valid: Type imports
import type {
  ServicesSectionProps,
  ServiceCard,
} from "@reiki-goddess/shared-components";
```

#### 2. Importing Design System

```typescript
// âœ… Import design tokens
import {
  colors,
  typography,
  layout,
  breakpoints,
} from "@reiki-goddess/design-system";

// Usage:
const heroStyle = {
  backgroundColor: colors.background.primary,
  fontSize: typography.heading.h1.fontSize,
  padding: layout.spacing.section,
};
```

#### 3. Importing Utilities

```typescript
// âœ… Import utility functions
import { formatDate, validateEmail } from "@reiki-goddess/shared-utils";
```

#### 4. Importing Assets

```typescript
// âœ… Import image references
import { logo, heroImage } from "@reiki-goddess/shared-assets";

// Note: Most images are in public/img/ and referenced directly:
<img src="/img/service-icon.svg" alt="Service" />
```

### Cross-Package Imports Within Packages

**TypeScript Project References** enable packages to import from each other:

```typescript
// In packages/shared-components/src/Header/Header.tsx
import { colors } from "@reiki-goddess/design-system";
import { formatDate } from "@reiki-goddess/shared-utils";

// TypeScript references in tsconfig.json ensure proper build order:
{
  "references": [
    { "path": "../design-system" },
    { "path": "../shared-utils" }
  ]
}
```

### Import Path Aliases Configuration

**Root tsconfig.json**:

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@reiki-goddess/shared-components": ["./packages/shared-components/src"],
      "@reiki-goddess/design-system": ["./packages/design-system/src"],
      "@reiki-goddess/shared-utils": ["./packages/shared-utils/src"],
      "@reiki-goddess/shared-assets": ["./packages/shared-assets"]
    }
  }
}
```

**Vite Config** (apps/main/vite.config.ts):

```typescript
{
  resolve: {
    alias: {
      "@reiki-goddess/shared-components": path.resolve(
        __dirname,
        "../../packages/shared-components/src"
      ),
      "@reiki-goddess/design-system": path.resolve(
        __dirname,
        "../../packages/design-system/src"
      ),
      "@reiki-goddess/shared-utils": path.resolve(
        __dirname,
        "../../packages/shared-utils/src"
      ),
      "@reiki-goddess/shared-assets": path.resolve(
        __dirname,
        "../../packages/shared-assets/src"
      )
    }
  }
}
```

### Component Export Pattern

**Central Export Hub** (`packages/shared-components/src/index.ts`):

```typescript
// All components exported from single index file
// Organized by category for clarity

// Layout components
export { AppLayout } from "./AppLayout";
export type { AppLayoutProps } from "./AppLayout";

// Service components
export { ServicesSection } from "./Services";
export type { ServicesSectionProps, ServiceCard } from "./Services";

// Complete page compositions
export { HomePage, AboutPage, ServicesPage } from "./pages";
```

**Individual Component Export** (e.g., `Services/index.ts`):

```typescript
export { ServicesSection } from "./ServicesSection";
export type { ServicesSectionProps, ServiceCard } from "./ServicesSection";
```

---

## Routing Integration

### React Router v6 Setup

**App.tsx** (apps/main/src/App.tsx):

```typescript
import { BrowserRouter, Routes, Route } from "react-router-dom";
import { AppLayout } from "@reiki-goddess/shared-components";
import Home from "./pages/Home";
import Services from "./pages/Services";
// ... other imports

function App() {
  return (
    <BrowserRouter
      future={{ v7_startTransition: true, v7_relativeSplatPath: true }}
    >
      <Routes>
        <Route path="/" element={<AppLayout />}>
          <Route index element={<Home />} />
          <Route path="about" element={<About />} />
          <Route path="services" element={<Services />} />
          <Route path="events" element={<Events />} />
          <Route path="contact" element={<Contact />} />
          <Route path="blog" element={<Blog />} />
          <Route path="*" element={<NotFound />} />
        </Route>
      </Routes>
    </BrowserRouter>
  );
}
```

### AppLayout Pattern

**AppLayout Component** provides consistent header/footer across all pages:

```typescript
// packages/shared-components/src/AppLayout/AppLayout.tsx
export const AppLayout: React.FC = () => {
  const location = useLocation();

  const navigationItems: NavigationItem[] = [
    { label: "Home", href: "/", isActive: location.pathname === "/" },
    { label: "About", href: "/about", isActive: location.pathname === "/about" },
    { label: "Services", href: "/services", isActive: location.pathname === "/services" },
    { label: "Events", href: "/events", isActive: location.pathname === "/events" },
    { label: "Blog", href: "/blog", isActive: location.pathname.startsWith("/blog") },
    { label: "Contact", href: "/contact", isActive: location.pathname === "/contact" }
  ];

  return (
    <div className="min-h-screen flex flex-col" style={{ backgroundColor: "#FFFBF5" }}>
      {/* Header - positioned absolutely to overlay content */}
      <div className="relative z-50" style={{ maxWidth: "1440px", margin: "0 auto" }}>
        <Header
          logo={{ src: "/img/Nav Bar Clickable Logo.png", alt: "The Reiki Goddess Healing" }}
          navigationItems={navigationItems}
        />
      </div>

      {/* Main content - negative margin compensates for header overlay */}
      <main className="flex-1" style={{ marginTop: "-93px" }}>
        <Outlet /> {/* Route content injected here */}
      </main>

      {/* Footer */}
      <div className="relative mx-auto" style={{ maxWidth: "1440px" }}>
        <Footer />
      </div>
    </div>
  );
};
```

**Key Architectural Details**:

- **Header Overlay**: Header positioned absolutely with z-index 50
- **Negative Margin**: Main content has `-93px` top margin to allow hero images to extend under header
- **Max Width Container**: 1440px maximum width (matches Figma designs)
- **Active State**: Navigation items compute active state from current route
- **Background Color**: `#FFFBF5` (cream) matches design system

### Adding Services Route

**Current State**:

```typescript
// apps/main/src/pages/Services.tsx (PLACEHOLDER)
import PageTransition from "../components/PageTransition";

function Services() {
  return (
    <PageTransition>
      <div className="min-h-screen bg-[#FFFBF5]">
        <div className="max-w-6xl mx-auto px-4 py-20">
          <h1 className="text-4xl font-bold text-[#0205B7] mb-4">Our Services</h1>
          <p className="text-gray-700">Services page</p>
        </div>
      </div>
    </PageTransition>
  );
}
```

**Recommended Implementation**:

```typescript
// apps/main/src/pages/Services.tsx (ENHANCED)
import PageTransition from "../components/PageTransition";
import { ServicesPage } from "@reiki-goddess/shared-components";

function Services() {
  return (
    <PageTransition>
      <ServicesPage />
    </PageTransition>
  );
}

export default Services;
```

**No Route Changes Needed**: The route `/services` is already configured in App.tsx.

### Page Transition Pattern

**PageTransition Component** (apps/main/src/components/PageTransition.tsx):

```typescript
import { motion } from "framer-motion";

const pageVariants = {
  initial: { opacity: 0, y: 20 },
  animate: { opacity: 1, y: 0, transition: { duration: 0.6, ease: "easeOut" } },
  exit: { opacity: 0, y: -20, transition: { duration: 0.4, ease: "easeIn" } }
};

export const PageTransition: React.FC<{ children: ReactNode }> = ({ children }) => {
  return (
    <motion.div
      initial="initial"
      animate="animate"
      exit="exit"
      variants={pageVariants}
    >
      {children}
    </motion.div>
  );
};
```

**Usage**: Wrap all page components with PageTransition for consistent animations.

---

## Build Configuration

### TypeScript Composite Projects

**Root tsconfig.json**:

```json
{
  "files": [],
  "references": [
    { "path": "./packages/shared-components" },
    { "path": "./packages/design-system" },
    { "path": "./packages/shared-utils" }
  ],
  "compilerOptions": {
    "composite": true,
    "declarationMap": true,
    "incremental": true
  }
}
```

**Package tsconfig.json** (e.g., shared-components):

```json
{
  "compilerOptions": {
    "composite": true,
    "declaration": true,
    "declarationMap": true,
    "outDir": "./dist",
    "rootDir": "./src"
  },
  "references": [{ "path": "../design-system" }, { "path": "../shared-utils" }]
}
```

**Benefits**:

- âœ… Incremental builds (only rebuild changed packages)
- âœ… Parallel builds across packages
- âœ… Proper dependency ordering
- âœ… Better IDE performance

### Vite Configuration

**Shared Vite Config** (vite.config.shared.ts):

```typescript
export const createViteConfig = (options: {
  entry: string;
  publicDir?: string;
  base?: string;
}) => {
  return defineConfig({
    plugins: [react()],
    resolve: {
      alias: {
        "@reiki-goddess/shared-components": resolve(
          __dirname,
          "packages/shared-components/src"
        ),
        "@reiki-goddess/design-system": resolve(
          __dirname,
          "packages/design-system/src"
        ),
        "@reiki-goddess/shared-utils": resolve(
          __dirname,
          "packages/shared-utils/src"
        ),
        "@reiki-goddess/shared-assets": resolve(
          __dirname,
          "packages/shared-assets"
        ),
      },
    },
    build: {
      rollupOptions: {
        output: {
          manualChunks(id) {
            if (id.includes("node_modules")) return "vendor";
            if (id.includes("@reiki-goddess/shared-components"))
              return "shared-components";
            if (id.includes("@reiki-goddess/design-system"))
              return "design-system";
          },
        },
      },
    },
  });
};
```

**Main App Vite Config** (apps/main/vite.config.ts):

```typescript
export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      "@reiki-goddess/shared-components": path.resolve(
        __dirname,
        "../../packages/shared-components/src"
      ),
      "@reiki-goddess/design-system": path.resolve(
        __dirname,
        "../../packages/design-system/src"
      ),
      "@reiki-goddess/shared-utils": path.resolve(
        __dirname,
        "../../packages/shared-utils/src"
      ),
      "@reiki-goddess/shared-assets": path.resolve(
        __dirname,
        "../../packages/shared-assets/src"
      ),
    },
  },
  server: {
    port: 5173,
    open: true,
  },
});
```

### Build Commands

**Root Level** (runs all packages):

```bash
npm run build          # Build all packages and apps
npm run dev            # Start all dev servers
npm run test           # Run all tests
npm run lint           # Lint all packages
npm run type-check     # TypeScript validation
```

**Package Level**:

```bash
# From root:
npm run build -w @reiki-goddess/shared-components
npm run test -w @reiki-goddess/main

# From package directory:
cd packages/shared-components
npm run build
npm test
```

### Build Order

TypeScript project references ensure correct build order:

1. **design-system** (no dependencies)
2. **shared-utils** (no dependencies)
3. **shared-assets** (no dependencies)
4. **shared-components** (depends on design-system, shared-utils)
5. **main** (depends on all packages)

**Automatic**: TypeScript handles this via `references` in tsconfig.json.

---

## Testing Architecture

### Test Configuration

**Shared Vitest Config** (vitest.config.shared.ts):

```typescript
export const createVitestConfig = (_packagePath: string) => {
  return defineConfig({
    plugins: [react()],
    test: {
      environment: "jsdom",
      setupFiles: [resolve(__dirname, "test-setup.ts")],
      globals: true,
      css: true,
      coverage: {
        provider: "v8",
        reporter: ["text", "json", "html"],
        exclude: [
          "node_modules/",
          "dist/",
          "**/*.d.ts",
          "**/*.config.*",
          "**/test-setup.ts",
        ],
      },
    },
    resolve: {
      alias: {
        "@reiki-goddess/shared-components": resolve(
          __dirname,
          "packages/shared-components/src"
        ),
        "@reiki-goddess/design-system": resolve(
          __dirname,
          "packages/design-system/src"
        ),
        "@reiki-goddess/shared-utils": resolve(
          __dirname,
          "packages/shared-utils/src"
        ),
        "@reiki-goddess/shared-assets": resolve(
          __dirname,
          "packages/shared-assets"
        ),
      },
    },
  });
};
```

### Test Structure

**Component Tests** (co-located with components):

```
packages/shared-components/src/
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ ServicesSection.tsx
â”‚   â”œâ”€â”€ ServicesSection.test.tsx    â† Test file
â”‚   â””â”€â”€ index.ts
```

**Integration Tests** (in main app):

```
apps/main/src/
â”œâ”€â”€ __tests__/
â”‚   â”œâ”€â”€ App.test.tsx
â”‚   â”œâ”€â”€ App.integration.test.tsx
â”‚   â””â”€â”€ routing.integration.test.tsx
```

### Test Utilities

**Router Wrapper** (for testing router-dependent components):

```typescript
// packages/shared-components/src/test-utils/RouterWrapper.tsx
import { MemoryRouter } from 'react-router-dom';

export const RouterWrapper: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  return <MemoryRouter>{children}</MemoryRouter>;
};

// Usage in tests:
import { render } from '@testing-library/react';
import { RouterWrapper } from '../test-utils';

render(
  <RouterWrapper>
    <Header />
  </RouterWrapper>
);
```

### Running Tests

```bash
# All tests in monorepo
npm test

# Specific package
npm test -w @reiki-goddess/shared-components

# Watch mode
npm test -- --watch

# Coverage
npm test -- --coverage

# Single file
npm test -- ServicesSection.test.tsx
```

### Test Statistics

**Current Test Coverage**:

- **shared-components**: 17 test files
- **main app**: 3 integration test files
- **Total**: ~62 component files, 17 tests (27% coverage)

**Services Page Testing**:

- Existing: `ServicesSection.test.tsx` (comprehensive)
- Needed: Tests for new ServicesPage components

---

## Services Page Integration Points

### Current Implementation Status

**Existing Assets**:

1. **ServicesSection Component** (`packages/shared-components/src/Services/ServicesSection.tsx`)
   - âœ… Fully implemented with 4 service cards
   - âœ… Responsive grid layout
   - âœ… Hover animations
   - âœ… Comprehensive tests
   - ğŸ“ Currently used on homepage

2. **ServicesPage Component** (`packages/shared-components/src/pages/ServicesPage.tsx`)
   - âœ… Basic structure with hero section
   - âœ… Uses ServicesSection
   - âœ… Includes BookSessionCTA
   - âš ï¸ Generic content, needs enhancement

3. **Route Placeholder** (`apps/main/src/pages/Services.tsx`)
   - âš ï¸ Basic placeholder
   - âœ… Has PageTransition wrapper
   - ğŸ¯ **TARGET FOR ENHANCEMENT**

### Integration Approach

**Recommended Strategy**: Three-tier enhancement

#### Tier 1: Quick Implementation (Current Assets)

**Update Route File**:

```typescript
// apps/main/src/pages/Services.tsx
import PageTransition from "../components/PageTransition";
import { ServicesPage } from "@reiki-goddess/shared-components";

function Services() {
  return (
    <PageTransition>
      <ServicesPage />
    </PageTransition>
  );
}

export default Services;
```

**Result**: Functional Services page using existing components.

#### Tier 2: Enhanced Components (New Components)

**Create New Components** in `packages/shared-components/src/Services/`:

1. **ServiceHero/** - Services page hero section

   ```typescript
   // ServiceHero/ServiceHero.tsx
   export interface ServiceHeroProps {
     title: string;
     subtitle: string;
     backgroundImage?: string;
   }

   export const ServiceHero: React.FC<ServiceHeroProps> = ({
     title,
     subtitle,
     backgroundImage
   }) => {
     return (
       <div className="relative h-[400px]" style={{ backgroundColor: "#FFFBF5" }}>
         {backgroundImage && (
           <img
             src={backgroundImage}
             alt=""
             className="absolute inset-0 w-full h-full object-cover opacity-20"
           />
         )}
         <div className="relative z-10 max-w-[1440px] mx-auto px-[66px] h-full flex flex-col justify-center">
           <h1 className="text-5xl font-bold text-[#0205B7] mb-4">{title}</h1>
           <p className="text-xl text-gray-600 max-w-3xl">{subtitle}</p>
         </div>
       </div>
     );
   };
   ```

2. **ServiceDetail/** - Individual service detail cards

   ```typescript
   // ServiceDetail/ServiceDetail.tsx
   export interface ServiceDetailProps {
     title: string;
     duration: string;
     price: string;
     description: string;
     benefits: string[];
     icon: React.ReactNode;
   }

   export const ServiceDetail: React.FC<ServiceDetailProps> = ({
     title,
     duration,
     price,
     description,
     benefits,
     icon
   }) => {
     return (
       <div className="bg-white rounded-[20px] p-8 shadow-lg">
         <div className="flex items-center mb-4">
           <div className="w-16 h-16 mr-4">{icon}</div>
           <div>
             <h3 className="text-2xl font-bold text-gray-900">{title}</h3>
             <p className="text-gray-600">{duration} â€¢ {price}</p>
           </div>
         </div>
         <p className="text-gray-700 mb-4">{description}</p>
         <h4 className="font-semibold text-gray-900 mb-2">Benefits:</h4>
         <ul className="list-disc list-inside text-gray-700">
           {benefits.map((benefit, index) => (
             <li key={index}>{benefit}</li>
           ))}
         </ul>
       </div>
     );
   };
   ```

3. **Update ServicesPage**:

   ```typescript
   // pages/ServicesPage.tsx
   import { ServiceHero } from "../Services/ServiceHero";
   import { ServicesSection } from "../Services/ServicesSection";
   import { ServiceDetail } from "../Services/ServiceDetail";
   import { BookSessionCTA } from "../BookSessionCTA";

   export const ServicesPage: React.FC = () => {
     return (
       <div className="min-h-screen">
         <ServiceHero
           title="Healing Services"
           subtitle="Discover transformative energy healing..."
         />

         <ServicesSection heading="Our Services" />

         <div className="max-w-[1440px] mx-auto px-[66px] py-20">
           <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
             <ServiceDetail
               title="Reiki Healing Sessions"
               duration="60/90 min"
               price="$120/$180"
               description="..."
               benefits={["...", "...", "..."]}
               icon={<img src="/img/reiki-icon.svg" alt="" />}
             />
             {/* More ServiceDetail components */}
           </div>
         </div>

         <div className="max-w-[1440px] mx-auto px-[66px] py-20">
           <BookSessionCTA />
         </div>
       </div>
     );
   };
   ```

#### Tier 3: Design Integration (Figma Designs)

**Use Figma Screenshots** from design documentation:

- Reference: `/docs/design/services-page/` (to be created)
- Source: Figma design files
- Extract: Colors, typography, spacing, layouts

**Design Token Integration**:

```typescript
import { colors, typography, layout } from "@reiki-goddess/design-system";

const serviceCardStyle = {
  backgroundColor: colors.background.white,
  borderRadius: "20px",
  padding: layout.spacing.card,
  fontFamily: typography.fontFamily.heading,
  color: colors.brand.blue,
};
```

### Integration Checklist

**Phase 1: Setup** âœ…

- [x] Services route exists at `/services`
- [x] AppLayout includes Services in navigation
- [x] ServicesSection component available
- [x] ServicesPage component exists

**Phase 2: Enhancement** ğŸ¯

- [ ] Update `apps/main/src/pages/Services.tsx` to use ServicesPage
- [ ] Create ServiceHero component
- [ ] Create ServiceDetail component
- [ ] Update ServicesPage with new components
- [ ] Add service content (text, images, pricing)
- [ ] Export new components from index.ts

**Phase 3: Testing** ğŸ¯

- [ ] Write tests for ServiceHero
- [ ] Write tests for ServiceDetail
- [ ] Update ServicesPage tests
- [ ] Add integration tests for Services route
- [ ] Test responsive layouts

**Phase 4: Polish** ğŸ¯

- [ ] Add animations to service cards
- [ ] Implement smooth scrolling between sections
- [ ] Optimize images
- [ ] Add SEO metadata
- [ ] Performance testing

### File Creation Checklist

**New Files to Create**:

1. âœ… `docs/design/services-page/architecture-integration.md` (this document)
2. ğŸ¯ `packages/shared-components/src/Services/ServiceHero/`
   - `ServiceHero.tsx`
   - `ServiceHero.test.tsx`
   - `index.ts`
3. ğŸ¯ `packages/shared-components/src/Services/ServiceDetail/`
   - `ServiceDetail.tsx`
   - `ServiceDetail.test.tsx`
   - `index.ts`
4. ğŸ¯ `packages/shared-components/src/Services/ServiceGrid/` (optional)
   - `ServiceGrid.tsx`
   - `ServiceGrid.test.tsx`
   - `index.ts`

**Files to Modify**:

1. ğŸ¯ `apps/main/src/pages/Services.tsx` - Replace placeholder with ServicesPage
2. ğŸ¯ `packages/shared-components/src/pages/ServicesPage.tsx` - Enhance with new components
3. ğŸ¯ `packages/shared-components/src/Services/index.ts` - Export new components
4. ğŸ¯ `packages/shared-components/src/index.ts` - Export new components

**No Changes Needed**:

- âœ… `apps/main/src/App.tsx` - Route already configured
- âœ… `packages/shared-components/src/AppLayout/AppLayout.tsx` - Navigation already includes Services
- âœ… Build configs - Already support new components

---

## Architectural Patterns to Follow

### 1. Component Structure Pattern

**Directory Structure**:

```
ComponentName/
â”œâ”€â”€ ComponentName.tsx           # Component implementation
â”œâ”€â”€ ComponentName.test.tsx      # Unit tests
â”œâ”€â”€ ComponentName.types.ts      # TypeScript interfaces (if complex)
â””â”€â”€ index.ts                    # Export barrel
```

**Component Template**:

```typescript
// ComponentName.tsx
import React from "react";

export interface ComponentNameProps {
  title: string;
  description?: string;
  className?: string;
}

/**
 * ComponentName - Brief description
 *
 * @param props - ComponentNameProps
 * @returns React component
 */
export const ComponentName: React.FC<ComponentNameProps> = ({
  title,
  description,
  className = ""
}) => {
  return (
    <div className={`component-base ${className}`}>
      <h2>{title}</h2>
      {description && <p>{description}</p>}
    </div>
  );
};
```

**Export Pattern**:

```typescript
// index.ts
export { ComponentName } from "./ComponentName";
export type { ComponentNameProps } from "./ComponentName";
```

### 2. Design System Integration Pattern

**Use Design Tokens**:

```typescript
import { colors, typography, layout } from "@reiki-goddess/design-system";

// âœ… Good: Use design tokens
const heroStyle = {
  backgroundColor: colors.background.primary,
  fontSize: typography.heading.h1.fontSize,
  padding: layout.spacing.section,
};

// âŒ Avoid: Hardcoded values
const heroStyle = {
  backgroundColor: "#FFFBF5",
  fontSize: "48px",
  padding: "80px",
};
```

**Tailwind CSS Pattern**:

```typescript
// âœ… Good: Tailwind utilities with design system colors
<div className="bg-[#FFFBF5] py-20 px-[66px]">

// âœ… Better: Custom Tailwind classes (if configured)
<div className="bg-cream py-section px-container">
```

### 3. Responsive Design Pattern

**Mobile-First Breakpoints**:

```typescript
// Breakpoints from design system
const breakpoints = {
  sm: "640px",   // Mobile landscape
  md: "768px",   // Tablet
  lg: "1024px",  // Desktop
  xl: "1280px",  // Large desktop
  "2xl": "1440px" // Max container width
};

// Tailwind responsive classes
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
  {/* 1 col mobile, 2 col tablet, 4 col desktop */}
</div>
```

**Container Pattern**:

```typescript
// Standard container (matches AppLayout)
<div className="max-w-[1440px] mx-auto px-[66px]">
  {/* Content */}
</div>

// Or use ResponsiveContainer component
import { ResponsiveContainer } from "@reiki-goddess/shared-components";

<ResponsiveContainer>
  {/* Content automatically gets max-width and padding */}
</ResponsiveContainer>
```

### 4. Animation Pattern

**Scroll-Based Animations**:

```typescript
import { AnimatedSection } from "@reiki-goddess/shared-components";

// Wrap sections for fade-in-on-scroll
<AnimatedSection delay={0.2}>
  <ServicesSection />
</AnimatedSection>

<AnimatedSection delay={0.4}>
  <BookSessionCTA />
</AnimatedSection>
```

**Hover Animations**:

```typescript
// CSS transitions for hover states
<div className="transition-all duration-300 transform hover:-translate-y-2">
  {/* Card content */}
</div>
```

### 5. Testing Pattern

**Component Test Template**:

```typescript
import { describe, it, expect } from 'vitest';
import { render, screen } from '@testing-library/react';
import { ComponentName } from './ComponentName';

describe('ComponentName', () => {
  it('renders with required props', () => {
    render(<ComponentName title="Test Title" />);
    expect(screen.getByText('Test Title')).toBeInTheDocument();
  });

  it('renders optional description', () => {
    render(
      <ComponentName
        title="Test Title"
        description="Test Description"
      />
    );
    expect(screen.getByText('Test Description')).toBeInTheDocument();
  });

  it('applies custom className', () => {
    const { container } = render(
      <ComponentName title="Test" className="custom-class" />
    );
    expect(container.firstChild).toHaveClass('custom-class');
  });
});
```

**Router-Dependent Component Test**:

```typescript
import { MemoryRouter } from 'react-router-dom';

it('renders with router', () => {
  render(
    <MemoryRouter>
      <ComponentWithLinks />
    </MemoryRouter>
  );
  expect(screen.getByRole('link')).toBeInTheDocument();
});
```

### 6. Type Safety Pattern

**Export Types with Components**:

```typescript
// ComponentName.tsx
export interface ComponentNameProps {
  title: string;
  items: ItemType[];
}

export interface ItemType {
  id: string;
  label: string;
}

export const ComponentName: React.FC<ComponentNameProps> = ({
  title,
  items,
}) => {
  // Implementation
};

// index.ts
export { ComponentName } from "./ComponentName";
export type { ComponentNameProps, ItemType } from "./ComponentName";
```

**Use Type Inference**:

```typescript
// âœ… Good: Type inference from props
const services = [
  { id: "reiki", title: "Reiki Healing", duration: "60 min" },
  { id: "sound", title: "Sound Therapy", duration: "90 min" }
];

<ServicesSection services={services} />

// TypeScript infers service type from ServicesSectionProps
```

### 7. Performance Optimization Pattern

**Lazy Loading**:

```typescript
// For route-level code splitting
const Services = lazy(() => import("./pages/Services"));

<Route path="services" element={
  <Suspense fallback={<LoadingSpinner />}>
    <Services />
  </Suspense>
} />
```

**Image Optimization**:

```typescript
// Use LazyImage component for automatic lazy loading
import { LazyImage } from "@reiki-goddess/shared-components";

<LazyImage
  src="/img/service-hero.jpg"
  alt="Service Hero"
  loading="lazy"
  decoding="async"
/>
```

**Memo for Expensive Renders**:

```typescript
import { memo } from "react";

export const ServiceCard = memo<ServiceCardProps>(({ title, description }) => {
  return (
    <div>
      <h3>{title}</h3>
      <p>{description}</p>
    </div>
  );
});
```

### 8. Accessibility Pattern

**Semantic HTML**:

```typescript
// âœ… Good: Semantic structure
<section aria-labelledby="services-heading">
  <h2 id="services-heading">Our Services</h2>
  <ul role="list">
    <li><a href="/services/reiki">Reiki Healing</a></li>
  </ul>
</section>

// âŒ Avoid: Div soup
<div>
  <div>Our Services</div>
  <div><div>Reiki Healing</div></div>
</div>
```

**ARIA Labels**:

```typescript
<button
  aria-label="Book Reiki Healing Session"
  onClick={handleBooking}
>
  Book Now
</button>
```

**Focus Management**:

```typescript
const modalRef = useRef<HTMLDivElement>(null);

useEffect(() => {
  if (isOpen && modalRef.current) {
    modalRef.current.focus();
  }
}, [isOpen]);

<div
  ref={modalRef}
  role="dialog"
  aria-modal="true"
  tabIndex={-1}
>
  {/* Modal content */}
</div>
```

---

## Summary and Next Steps

### Architecture Summary

The Reiki Goddess Healing monorepo is well-architected for **scalable component development**:

âœ… **Strengths**:

- Clean separation between reusable components and app-specific code
- TypeScript project references enable incremental builds
- Consistent design system integration
- Comprehensive testing infrastructure
- Well-documented architectural patterns

ğŸ¯ **Services Page Integration Strategy**:

1. **Quick Win**: Update `apps/main/src/pages/Services.tsx` to use existing ServicesPage
2. **Enhancement**: Create ServiceHero and ServiceDetail components in shared-components
3. **Polish**: Add animations, optimize images, implement design tokens

### Immediate Next Steps

**For Implementation Team**:

1. **Read Related Documentation**:
   - `/docs/project/ARCHITECTURE.md` - Full architecture patterns
   - `/docs/design/style-guide.md` - Visual design specifications
   - `/packages/shared-components/CLAUDE.md` - Component development guidelines

2. **Set Up Development Environment**:

   ```bash
   npm install                    # Install all dependencies
   npm run dev                    # Start dev server (port 5173)
   npm run build                  # Verify build works
   npm test                       # Run existing tests
   ```

3. **Create Service Components**:
   - Start with ServiceHero component
   - Create ServiceDetail component
   - Update ServicesPage composition
   - Write tests for new components

4. **Update Main App Route**:
   - Modify `apps/main/src/pages/Services.tsx`
   - Import and use enhanced ServicesPage
   - Verify PageTransition wrapper works

5. **Test Integration**:
   - Run component tests: `npm test`
   - Manual testing in browser
   - Test responsive layouts
   - Verify navigation active states

### Development Workflow

```bash
# Terminal 1: Dev server
npm run dev

# Terminal 2: Test watcher
npm test -- --watch

# Terminal 3: Type checking
npm run type-check -- --watch
```

### Key Files Reference

**Must Read**:

- `/apps/main/src/App.tsx` - Routing setup
- `/packages/shared-components/src/AppLayout/AppLayout.tsx` - Layout pattern
- `/packages/shared-components/src/Services/ServicesSection.tsx` - Existing service component
- `/packages/shared-components/src/pages/ServicesPage.tsx` - Page composition

**Reference**:

- `/docs/project/ARCHITECTURE.md` - Detailed patterns
- `/packages/design-system/src/colors.ts` - Color palette
- `/packages/design-system/src/typography.ts` - Font definitions
- `/packages/design-system/src/layout.ts` - Spacing and sizing

### Support Resources

**Internal Documentation**:

- Project setup: `/docs/project/PROJECT_SETUP.md`
- Migration guide: `/docs/project/MIGRATION_GUIDE.md`
- Testing guide: `/docs/testing/TESTING_SUMMARY.md`

**Component Examples**:

- Contact page: `/packages/shared-components/src/pages/ContactPage.tsx`
- About page: `/packages/shared-components/src/pages/AboutPage.tsx`
- Homepage: `/packages/shared-components/src/pages/HomePage.tsx`

---

## Appendix

### Package Dependency Matrix

| Package           | Depends On                  | Used By                 |
| ----------------- | --------------------------- | ----------------------- |
| design-system     | (none)                      | shared-components, main |
| shared-utils      | (none)                      | shared-components, main |
| shared-assets     | (none)                      | shared-components, main |
| shared-components | design-system, shared-utils | main                    |
| main              | All packages                | (none)                  |

### Component Inventory

**Layout Components** (9):

- AppLayout, ResponsiveContainer, HeaderSection, FooterSection, Header, Footer, AnimatedSection, LazyImage, BookSessionCTA

**Page Compositions** (6):

- Homepage, HomePage, AboutPage, ServicesPage, ContactPage, EventsPage, BlogPage

**Section Components** (8):

- Hero, HeroV2, FeaturesBar, MeetTheGoddess, ServicesSection, CommunityEvents, Testimonials, LetsConnect

**Form Components** (4):

- SecureContactForm, FigmaContactForm, ContactInfoCard, GoogleMapEmbed

**Utility Components** (3):

- Button, PrivacyCompliance, Demo

**Total**: 35+ exported components

### TypeScript Configuration Summary

**Compiler Options**:

- Target: ES2020
- Module: ESNext
- JSX: react-jsx
- Strict mode: enabled
- Source maps: enabled
- Declaration maps: enabled (for project references)

**Path Aliases**:

- `@reiki-goddess/shared-components` â†’ `packages/shared-components/src`
- `@reiki-goddess/design-system` â†’ `packages/design-system/src`
- `@reiki-goddess/shared-utils` â†’ `packages/shared-utils/src`
- `@reiki-goddess/shared-assets` â†’ `packages/shared-assets`

### Build Performance Metrics

**Typical Build Times**:

- Full monorepo build: ~15-20 seconds
- Incremental build (one package): ~2-5 seconds
- Hot reload (dev mode): ~200-500ms

**Bundle Sizes** (production):

- Vendor chunk: ~150-200 KB (gzipped)
- Shared components chunk: ~50-80 KB (gzipped)
- Design system chunk: ~10-15 KB (gzipped)
- Main app chunk: ~30-50 KB (gzipped)

---

**Document Version**: 1.0
**Last Updated**: 2025-10-15
**Next Review**: After Services page implementation
**Maintainer**: Architecture Mapper Agent
